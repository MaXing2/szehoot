<!DOCTYPE html>
<html>
	<head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Scriptek -->
        <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script> <!-- Iconfy -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> <!-- jQuery -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script> <!-- Boostrap -->
        <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script> <!-- Bootstrap táblázatok -->
        <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/extensions/mobile/bootstrap-table-mobile.min.js"></script> <!-- Bootstrap mobil stíluslap -->
        <script src="../javascripts/bootstrap-table-hu-HU.min.js"></script>  <!-- Magyarítás -->
        <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery.form/3.51/jquery.form.min.js"></script> <!-- jQuery form -->
        <script src="/minified/sceditor.min.js"></script> <!-- BB code -->
        <script src="/socket.io/socket.io.js"></script> <!-- Socket.io -->
        <script src="/minified/formats/bbcode.js"></script> <!-- BB code -->   
        <script src="../javascripts/bbCodeParser.min.js"></script>

        


        <!-- Stíluslapok -->
        <link rel="stylesheet" href="../stylesheets/bootstrap/bootstrap.min.css"> <!-- Bootstrap stíluslap-->
        <link rel="stylesheet" href="../stylesheets/main_styles.css"> <!-- Fő stíluslap -->
        <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css"> <!-- Bootstrap táblázatok stíluslap -->
        <link rel="stylesheet" href="/minified/themes/default.min.css" /> <!-- BB code stíluslap -->
        <!-- <link rel="stylesheet" href="../stylesheets/edit.css"> Teszt szerkesztő stíluslap -->

        

        <% if (typeof title == 'undefined') { %>
            <title> Szehoot </title>
          <% } else { %>
            <title> Szehoot - <%= title %> </title>
          <% } %>


        <!-- SVG rész -->
        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
          <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
          </symbol>
          <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
          </symbol>
          <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
          </symbol>

        </svg>


    </head>
	<body>
    <!-- Ezeket majd külön JS fájlba fogom tenni!! -->

<script>
function InitPopup () {
  //popup információs ablak
    var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
    var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
    return new bootstrap.Popover(popoverTriggerEl)
  })
   // var popover = new bootstrap.Popover(document.querySelector('#category-info'), {
  // trigger: 'hover'
  // })

};

$(document).ready(function() {
    // A megfelelő navigációs link aktívvá tétele az oldal betöltése után
    //  $("#<%= page%>").addClass("active"); Villogó effektus miatt nem használandó

    //  Navigációs link aktívvá tétele kattintás után
    // $(function() {
    //     $(".main").click(function() {
    //         $("a").removeClass("active");
    //         $(this).addClass("active");
    //     });
    // });
    InitPopup();
});


function LoadDataToModal(modal, id, test_subcategory) {

  if (modal != 'deleteTestProcess') { //A tesztfolyamat törléséhez erre nincs szükség, és több helyről is lehetséges, ahol nem létezik a táblázat
  var td = $('#table td').filter( ":nth-child(1)" ).filter(function(){
    return $(this).text() === id;
  })
  var Row = td.parent('tr'); 
  var test_name = Row.find("td:eq(1)").text(); // teszt neve
  }

switch(modal) {

case 'newTestProcess':
  $("#test_id").val(id);
  createTestProcessModal.show();
  break;

  case 'deleteTestProcess':
  $("#process_id_dp").val(id);
  $("#page_dp").val(window.location.pathname);
  deleteTestProcessModal.show();
  break;

case 'duplicateTest':
  $('#test_name_dt').val(test_name + ' - másolat');  //a tr 1. td eleme a teszt neve
  $('#newCatCheck').prop('checked', false);
  $("#test_id_dt").val(id);
  $("#cat_id_dt").val(test_subcategory);
  originalCatId = $('#cat_id_dt').val(); //eredeti kategória ID eltárolása
  $('#duplicateTestModal .maincat').addClass('d-none');
  $('#duplicateTestModal .subcat').addClass('d-none');  
  duplicateTestModal.show();
  break;

case 'renameTest':
  $("#test_id_rt").val(id);
  $("#test_name_rt").attr('placeholder', test_name);
  renameTestModal.show();
  break;

case 'moveTest':
  $("#test_id_mt").val(id);
  getMainCategory('moveTest');
  moveTestModal.show();
  break;

case 'printTest':
  $("#test_id_pt").val(id);
  printTestModal.show();
  break;

case 'deleteTest':
  $("#test_id_delt").val(id);
  deleteTestModal.show();
  break;

default:
  // code block
}}

function calculateGrade(percentage, classification) {
  percentage = parseInt(percentage);
  var gradeText = '';
  const values = classification.split(";");
  switch (true) {
    case (percentage >= parseInt(values[8])):
      gradeText = "Jeles";
      break;
      case percentage >= parseInt(values[6]):
      gradeText = "Jó";
      break;
      case percentage >= parseInt(values[4]):
      gradeText = "Közepes";
      break;
      case percentage >= parseInt(values[2]):
      gradeText = "Elégséges";
      break;
      case percentage >= parseInt(values[0]):
      gradeText = "Elégtelen";
      break;
  }
  return gradeText;
}

           </script>

                
<header>
		<nav id="navbar" class="navbar navbar-expand-lg navbar-dark bg-dark">
			<div class="container-fluid">
			  <a class="navbar-brand" href="/">SZEHOOT<p id="version">v1.0</p></a>

			  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			  </button>
			  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                  <!-- Balra zárt menü -->
				<div class="navbar-nav">

                    
                <% if (loggedIn) { %>
                    <a id="home" class="nav-link main <%= page === 'home' && 'active' %>" href="/home"> <span class="iconify" data-icon="ant-design:home-outlined"></span>  Kezdőlap</a>
                    <!-- <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarScrollingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Teszt</a>
                        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarScrollingDropdown">
                            <li><a class="dropdown-item nav-link main" href="test_categorys">Kategóriák</a></li>
                            <li><a class="dropdown-item nav-link main" href="test_create">Létrehozás</a></li>
                          <li><a class="dropdown-item nav-link main" href="test_bank">Tesztbank</a></li>
                        </ul>
                      </li> -->
                    <a id="test_bank" class="nav-link main <%= page === 'test_bank' && 'active' %>" href="/test/bank"><span class="iconify" data-icon="feather:database"></span> Tesztbank</a>
                    <a id="test_category" class="nav-link main <%= page === 'test_category' && 'active' %>" href="/test/category"><span class="iconify" data-icon="bx:bx-category-alt"></span> Kategóriák</a>
                    <a id="test_process" class="nav-link main <%= page === 'test_process' && 'active' %>" href="/test/process"><span class="iconify" data-icon="ant-design:unordered-list-outlined"></span> Tesztfolyamatok</a>
                    <a id="test_create" onClick="getMainCategory('newTest');" class="nav-link d-lg-none main <%= page === 'test_create' && 'active' %>" href="#">Létrehozás</a>
                    <a id="test_join" onClick="" data-bs-toggle="modal" data-bs-target="#joinTestModal" class="nav-link d-lg-none main" href="#">Csatlakozás</a>

                <% } %>
				  
				</div>
                <!-- Jobbra zárt menü -->
				<div class="navbar-nav ms-auto flex-nowrap">
                <% if (!loggedIn) { %>
                    <a class="nav-link main" href="signup"><span class="iconify" data-icon="ant-design:user-add-outlined" data-inline="false"></span> Regisztráció</a>
                    <a class="nav-link main" href="login"><span class="iconify" data-icon="clarity:login-line" data-inline="false"></span> Bejelentkezés</a>
                <% } else {%>

                  <div class="button btn-create me-1 d-none d-lg-block">
                    <a class="nav-link main" onClick="getMainCategory('newTest');" class="nav-link main" href="#">
                      <span class="iconify" data-icon="gridicons:create"></span> Létrehozás
                    </a>
                    <div class="mask"></div>
                  </div>
                  <div class="button btn-join me-1 d-none d-lg-block">
                    <a class="nav-link main" data-bs-toggle="modal" data-bs-target="#joinTestModal" class="nav-link main" href="#">
                      <span class="iconify" data-icon="radix-icons:enter"></span> Kitöltés
                    </a>
                    <div class="mask"></div>
                  </div>
                    <!-- <a class="nav-link" href="#"><span class="iconify" data-icon="ant-design:user-outlined" data-inline="false"></span> Profilom</a> -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarScrollingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"><span class="iconify" data-icon="ant-design:user-outlined" data-inline="false"></span> <%= username%></a>
                        <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarScrollingDropdown">
                          <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#editProfileModal" href="#">Profilom</a></li>
                          <li><hr class="dropdown-divider"></li>
                          <li><a class="dropdown-item" href="/logout">Kijelentkezés</a></li>
                        </ul>
                      </li>
                    <% }%>
				  </div>
			  </div>
			</div>
		</nav>
</header>

